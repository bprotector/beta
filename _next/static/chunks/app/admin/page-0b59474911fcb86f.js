(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1781:(e,t,a)=>{Promise.resolve().then(a.bind(a,7220))},7220:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(5155),n=a(2115),i=a(1392),o=a(3570),l=a(558),s=a(5799),c=a(1934),d=a(1673),m=a(4618),u=a(9229),p=a(7358);let f=new o.PublicKey("DTh9fWEHJiktBGdZEHsMsohdmFPaCyFCL1eoTt443zWe"),g=p.env.NEXT_PUBLIC_SOLANA_RPC_ENDPOINT||"https://api.devnet.solana.com";function h(e){if(!e.publicKey||!e.signTransaction||!e.signAllTransactions)throw Error("Wallet not connected or missing required methods");return{publicKey:e.publicKey,signTransaction:e.signTransaction,signAllTransactions:e.signAllTransactions}}function b(){let{publicKey:e,signTransaction:t,signAllTransactions:a,sendTransaction:p,connected:b}=(0,i.v)(),[y,x]=(0,n.useState)(null),[w,j]=(0,n.useState)(null),[v,P]=(0,n.useState)(!1),[k,T]=(0,n.useState)(!1),[S,R]=(0,n.useState)(""),[C,z]=(0,n.useState)(""),[B,W]=(0,n.useState)(""),[F,N]=(0,n.useState)(""),[A,E]=(0,n.useState)(!1),[O,M]=(0,n.useState)(!1),[U,L]=(0,n.useState)(!1),[I,D]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let r=null,n=null,i=null;return(async()=>{if(!b||!e||!t||!a||!p)return s.oR.error("Wallet not connected");try{let c=new o.Connection(g,"confirmed"),m=h({publicKey:e,signTransaction:t,signAllTransactions:a}),p=new l.NQ(c,m,{commitment:"confirmed"});r=new l.BP(d,f,p);let b=await (0,u.GT)(r);if(x(b),P(!!b),b){let t=b.owner.toBase58()===e.toBase58();T(t)}let y=await (0,u.uz)(r);j(y),n=(0,u.gA)(r,(e,t)=>{x(t=>t?{...t,feeAmount:e}:t),j(t=>t?{...t,feeAmount:e}:t),s.oR.info("Fee updated to ".concat(e/1e9," SOL by ").concat(t.toBase58().slice(0,4),"..."))}),i=(0,u.zJ)(r,(e,t)=>{x(t=>t?{...t,maxTrials:e}:t),j(t=>t?{...t,maxTrials:e}:t),s.oR.info("Max trials updated to ".concat(e," by ").concat(t.toBase58().slice(0,4),"..."))})}catch(e){P(!1),s.oR.error("Failed to load program state or contract infos")}})(),()=>{r&&(null!==n&&r.removeEventListener(n),null!==i&&r.removeEventListener(i))}},[e,t,a,p,b]);let _=(0,n.useCallback)(async r=>{if(r.preventDefault(),W(""),N(""),E(!0),!b||!e||!t||!a||!p){W("Wallet not connected"),s.oR.error("Please connect your wallet"),E(!1);return}try{let r=new o.Connection(g,"confirmed"),n=h({publicKey:e,signTransaction:t,signAllTransactions:a}),i=new l.NQ(r,n,{commitment:"confirmed"}),c=new l.BP(d,f,i),m=await (0,u.BI)(n,r,p),b=await (0,u.GT)(c),y=await (0,u.uz)(c);x(b),j(y),P(!0),T(!0),N("Program initialized! Transaction: ".concat(m.slice(0,4),"...")),s.oR.success("Program initialized! Transaction: ".concat(m.slice(0,4),"..."))}catch(t){let e=t instanceof Error&&t.message.includes("6000")?"Unauthorized: Only the program owner can initialize":"Initialization failed: ".concat(t instanceof Error?t.message:"Unknown error");W(e),s.oR.error(e)}finally{E(!1)}},[e,t,a,p,b]),H=(0,n.useCallback)(async r=>{if(r.preventDefault(),W(""),N(""),M(!0),!b||!e||!t||!a||!p){W("Wallet not connected"),s.oR.error("Please connect your wallet"),M(!1);return}let n=parseFloat(S);if(isNaN(n)||n<=0){W("Invalid fee amount"),s.oR.error("Please enter a valid positive fee in SOL"),M(!1);return}try{let r=new o.Connection(g,"confirmed"),i=h({publicKey:e,signTransaction:t,signAllTransactions:a}),c=new l.NQ(r,i,{commitment:"confirmed"}),m=new l.BP(d,f,c),b=await (0,u.gH)(m,r,e,Math.round(1e9*n),p),y=await (0,u.GT)(m),w=await (0,u.uz)(m);x(y),j(w),N("Fee updated to ".concat(n," SOL! Transaction: ").concat(b.slice(0,4),"...")),s.oR.success("Fee updated to ".concat(n," SOL!")),R("")}catch(t){let e="Failed to update fee: ".concat(t instanceof Error?t.message:"Unknown error");t instanceof Error&&(t.message.includes("6000")?e="Unauthorized: Only the owner can update fees":t.message.includes("6003")?e="Fee cannot be zero":t.message.includes("6004")?e="Fee is too large":t.message.includes("rejected")?e="Transaction rejected by wallet":t.message.includes("blockhash")&&(e="Invalid or expired blockhash")),W(e),s.oR.error(e)}finally{M(!1)}},[e,t,a,p,S,b]),G=(0,n.useCallback)(async r=>{if(r.preventDefault(),W(""),N(""),L(!0),!b||!e||!t||!a||!p){W("Wallet not connected"),s.oR.error("Please connect your wallet"),L(!1);return}let n=Number(C);if(isNaN(n)||n<=0||n>100){W("Invalid max trials amount (1â€“100)"),s.oR.error("Please enter a valid max trials value between 1 and 100"),L(!1);return}try{let r=new o.Connection(g,"confirmed"),i=h({publicKey:e,signTransaction:t,signAllTransactions:a}),c=new l.NQ(r,i,{commitment:"confirmed"}),m=new l.BP(d,f,c),b=await (0,u.yL)(m,r,e,n,p),y=await (0,u.GT)(m),w=await (0,u.uz)(m);x(y),j(w),N("Max trials updated to ".concat(n,"! Transaction: ").concat(b.slice(0,4),"...")),s.oR.success("Max trials updated to ".concat(n,"!")),z("")}catch(t){let e="Failed to update max trials: ".concat(t instanceof Error?t.message:"Unknown error");t instanceof Error&&(t.message.includes("6000")?e="Unauthorized: Only the owner can update max trials":t.message.includes("6005")?e="Max trials cannot be zero":t.message.includes("6006")?e="Max trials is too large":t.message.includes("rejected")?e="Transaction rejected by wallet":t.message.includes("blockhash")&&(e="Invalid or expired blockhash")),W(e),s.oR.error(e)}finally{L(!1)}},[e,t,a,p,C,b]),Q=(0,n.useCallback)(async r=>{if(r.preventDefault(),W(""),N(""),D(!0),!b||!e||!t||!a||!p){W("Wallet not connected"),s.oR.error("Please connect your wallet"),D(!1);return}try{let r=new o.Connection(g,"confirmed"),n=h({publicKey:e,signTransaction:t,signAllTransactions:a}),i=new l.NQ(r,n,{commitment:"confirmed"}),c=new l.BP(d,f,i),m=await (0,u.NP)(c,r,e,p);x(null),j(null),P(!1),T(!1),N("Accounts closed! Transaction: ".concat(m.slice(0,4),"...")),s.oR.success("Accounts closed!")}catch(t){let e="Close accounts failed: ".concat(t instanceof Error?t.message:"Unknown error");t instanceof Error&&(t.message.includes("6000")?e="Unauthorized: Only the owner can close accounts":t.message.includes("rejected")?e="Transaction rejected by wallet":t.message.includes("blockhash")&&(e="Invalid or expired blockhash")),W(e),s.oR.error(e)}finally{D(!1)}},[e,t,a,p,b]),K=(0,n.useCallback)(e=>{if(!navigator.clipboard)return void s.oR.error("Clipboard API not supported in this browser");navigator.clipboard.writeText(e).then(()=>{s.oR.success("Copied to clipboard!"),N("Copied to clipboard!"),setTimeout(()=>N(""),2e3)}).catch(()=>{s.oR.error("Failed to copy")})},[]);return(0,r.jsx)("div",{style:{minHeight:"100vh",padding:"3rem 0",background:"linear-gradient(to bottom, #111827, #000000)",color:"#d1d5db"},children:(0,r.jsxs)("div",{style:{maxWidth:"48rem",margin:"0 auto",padding:"0 1rem"},children:[(0,r.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,r.jsx)(m.A,{activeMode:"admin",isContractOwner:k})}),(0,r.jsxs)(c.P.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},style:{textAlign:"center",marginBottom:"3rem"},children:[(0,r.jsx)("h1",{style:{fontSize:"2.25rem",fontWeight:"700",color:"#f97316",marginBottom:"1rem"},children:"Admin Panel"}),(0,r.jsx)("p",{style:{fontSize:"1.125rem",color:"#9ca3af",maxWidth:"32rem",margin:"0 auto"},children:"Manage the BProtector program: initialize, update fees, set trial counts, or close accounts."})]}),(0,r.jsxs)(c.P.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",padding:"2rem",borderRadius:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.1)",width:"100%",maxWidth:"48rem"},children:[B&&(0,r.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(239, 68, 68, 0.2)",color:"#f87171",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:B}),F&&(0,r.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(34, 197, 94, 0.2)",color:"#4ade80",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:F}),!e&&(0,r.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(234, 179, 8, 0.2)",color:"#facc15",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:"Please connect your wallet to access the admin panel."}),e&&!v&&(0,r.jsx)("form",{onSubmit:_,style:{marginBottom:"1.5rem"},children:(0,r.jsx)(c.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:A,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:A?"#4b5563":"#f97316",color:"#ffffff",cursor:A?"not-allowed":"pointer"},children:A?"Initializing...":"Initialize Program"})}),e&&v&&!k&&(0,r.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(239, 68, 68, 0.2)",color:"#ffffff",padding:"1rem",borderRadius:"0.5rem",textAlign:"center"},children:"Access restricted to program owner."}),e&&v&&k&&(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,r.jsxs)(c.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",padding:"1.5rem",borderRadius:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.1)",width:"100%",maxWidth:"48rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#f97316",marginBottom:"1rem"},children:"Contract Information"}),w?(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#d1d5db",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Owner:"})," ",(0,r.jsxs)("span",{style:{cursor:"pointer",color:"#fb923c"},onClick:()=>K(w.owner.toBase58()),children:[w.owner.toBase58().slice(0,8),"...",w.owner.toBase58().slice(-4)]})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Program State PDA:"})," ",(0,r.jsxs)("span",{style:{cursor:"pointer",color:"#fb923c"},onClick:()=>K(w.programStatePda.toBase58()),children:[w.programStatePda.toBase58().slice(0,8),"...",w.programStatePda.toBase58().slice(-4)]})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Fee Amount:"})," ",w.feeAmount/1e9," SOL"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Maximum Trials:"})," ",w.maxTrials]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Bump:"})," ",w.bump]})]}):(0,r.jsx)("p",{style:{color:"#9ca3af"},children:"Loading contract information..."})]}),(0,r.jsxs)(c.P.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},onSubmit:H,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#f97316"},children:"Update Fee"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"newFee",style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#d1d5db"},children:"New Fee (SOL)"}),(0,r.jsx)("input",{type:"number",id:"newFee",value:S,onChange:e=>R(e.target.value),placeholder:"e.g., 0.01",step:"0.000000001",min:"0.000000001","aria-label":"New fee in SOL",style:{marginTop:"0.25rem",width:"100%",background:"rgba(31, 41, 55, 0.5)",color:"#d1d5db",border:"1px solid #4b5563",borderRadius:"0.5rem",padding:"0.5rem 0.75rem",outline:"none",transition:"all 0.2s"},disabled:O})]}),(0,r.jsx)(c.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:O,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:O?"#4b5563":"#f97316",color:"#ffffff",cursor:O?"not-allowed":"pointer"},children:O?"Updating...":"Update Fee"})]}),(0,r.jsxs)(c.P.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},onSubmit:G,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#f97316"},children:"Update Max Trials"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"newMaxTrials",style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#d1d5db"},children:"New Max Trials (1â€“100)"}),(0,r.jsx)("input",{type:"number",id:"newMaxTrials",value:C,onChange:e=>z(e.target.value),placeholder:"e.g., 3",min:"1",max:"100","aria-label":"New max trials",style:{marginTop:"0.25rem",width:"100%",background:"rgba(31, 41, 55, 0.5)",color:"#d1d5db",border:"1px solid #4b5563",borderRadius:"0.5rem",padding:"0.5rem 0.75rem",outline:"none",transition:"all 0.2s"},disabled:U})]}),(0,r.jsx)(c.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:U,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:U?"#4b5563":"#f97316",color:"#ffffff",cursor:U?"not-allowed":"pointer"},children:U?"Updating...":"Update Max Trials"})]}),(0,r.jsxs)(c.P.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.8},onSubmit:Q,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,r.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#f97316"},children:"Close Accounts"}),(0,r.jsx)(c.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:I,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:I?"#4b5563":"#dc2626",color:"#ffffff",cursor:I?"not-allowed":"pointer"},children:I?"Closing...":"Close Accounts"})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[956,867,33,865,436,643,441,684,358],()=>t(1781)),_N_E=e.O()}]);