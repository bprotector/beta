(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[167],{3533:(e,r,o)=>{"use strict";o.d(r,{A:()=>i});var t=o(5155),n=o(2115);function i(e){let{label:r,value:o,onChange:i,disabled:a}=e,[s,l]=(0,n.useState)(!1);return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("label",{style:{display:"block",color:"rgb(209, 213, 219)",marginBottom:"8px",fontSize:"1rem"},children:r}),(0,t.jsx)("input",{type:s?"text":"password",value:o,onChange:e=>i(e.target.value),placeholder:"Enter ".concat(r.toLowerCase()),disabled:a,style:{width:"100%",padding:"12px 40px 12px 12px",color:"rgb(249, 115, 22)",borderRadius:"0.375rem",fontSize:"1rem",outline:"none",transition:"box-shadow 0.2s"}}),(0,t.jsx)("button",{type:"button","aria-label":s?"Hide password":"Show password",onClick:()=>{l(!s)},disabled:a,style:{position:"absolute",right:"10px",top:"70%",transform:"translateY(-50%)",background:"none",border:"none",color:a?"rgb(75, 85, 99)":"rgb(107, 114, 128)",cursor:a?"not-allowed":"pointer",outline:"none",transition:"color 0.2s"},children:(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",style:{width:"20px",height:"20px"},children:s?(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"}):(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})})})]})}},5455:(e,r,o)=>{"use strict";o.r(r),o.d(r,{default:()=>j});var t=o(5155),n=o(2115),i=o(1392),a=o(3570),s=o(558),l=o(5695);function c(e){let{label:r,accept:o,onChange:i,fileName:a,disabled:s}=e,l=(0,n.useRef)(null);return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium",children:r}),(0,t.jsx)("input",{type:"file",accept:o,ref:l,onChange:e=>{i(e.target.files?e.target.files[0]:null)},disabled:s,className:"w-full p-3 bg-gray-700 text-orange-500 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-orange-500 file:text-black hover:file:bg-orange-600 ".concat(s?"opacity-50 cursor-not-allowed":"")}),a&&(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:["Selected: ",a]})]})}var d=o(3533),p=o(4618),m=o(1934);function u(e){let{isOpen:r,onClose:o,message:i}=e;return(console.log("[ErrorModal] Rendering modal, isOpen:",r,"message:",i),(0,n.useEffect)(()=>{console.log("[ErrorModal] Adding Escape key listener");let e=e=>{"Escape"===e.key&&(console.log("[ErrorModal] Escape key pressed, closing modal"),o())};return window.addEventListener("keydown",e),()=>{console.log("[ErrorModal] Removing Escape key listener"),window.removeEventListener("keydown",e)}},[o]),r)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full border border-gray-600",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-orange-500 mb-4",children:"Error"}),(0,t.jsx)("p",{className:"text-white bg-red-900/50 p-3 rounded-md mb-6",children:i}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:()=>{console.log("[ErrorModal] Close button clicked"),o()},className:"bg-orange-500 hover:bg-orange-600 text-black font-semibold py-2 px-4 rounded",children:"Close"})})]})}):(console.log("[ErrorModal] Modal not open, returning null"),null)}var g=o(9229),h=o(9777),f=o(8384),y=o(1673),b=o(5799),x=o(4134).Buffer;function w(e){if(!e.publicKey||!e.signTransaction||!e.signAllTransactions)throw Error("Wallet not connected or missing required methods");return{publicKey:e.publicKey,signTransaction:e.signTransaction,signAllTransactions:e.signAllTransactions}}let v=new a.PublicKey("DTh9fWEHJiktBGdZEHsMsohdmFPaCyFCL1eoTt443zWe"),k=new a.Connection("https://api.devnet.solana.com","confirmed");function j(){let{publicKey:e,signTransaction:r,signAllTransactions:o,sendTransaction:a,connected:j}=(0,i.v)(),E=(0,l.useRouter)(),[C,S]=(0,n.useState)(null),[z,R]=(0,n.useState)(""),[F,P]=(0,n.useState)(""),[N,B]=(0,n.useState)(""),[I,L]=(0,n.useState)(""),[A,D]=(0,n.useState)(""),[T,U]=(0,n.useState)(null),[M,W]=(0,n.useState)(!0),[H,K]=(0,n.useState)(!1),[O,_]=(0,n.useState)(!1),[q,G]=(0,n.useState)(""),[V,Y]=(0,n.useState)(!1),[Z,Q]=(0,n.useState)(null),[J,$]=(0,n.useState)(null),[X,ee]=(0,n.useState)([]),[er,eo]=(0,n.useState)(!1),et=e=>{ee(r=>[...r,"".concat(new Date().toISOString(),": ").concat(e)].slice(-50))};(0,n.useEffect)(()=>{if(!j||!e||!r||!o||!a){W(!0),Y(!1),E.push("/"),et("Wallet not connected, redirecting to home");return}let t=!0;return(async()=>{try{et("Initializing wallet connection...");let n=w({publicKey:e,signTransaction:r,signAllTransactions:o}),i=new s.NQ(k,n,{commitment:"confirmed"}),a=new s.BP(y,v,i);et("Fetching contract owner...");let l=await (0,g.eE)(a);t&&(Y(e.equals(l)),et("Contract owner check: ".concat(e.equals(l)?"User is owner":"User is not owner"))),et("Fetching program state...");let c=await (0,g.GT)(a);t&&(c?(Q(c),et("Program state fetched successfully")):et("Program state not found, setting to null")),et("Fetching user trials...");let d=await (0,g.bt)(a,e);t&&(d?($({...d,user:e}),et("User trials fetched: ".concat(d.trialCount," trials"))):($({user:e,trialCount:0,bump:0}),et("New user: No trials account exists, initialized with 0 trials")))}catch(e){if(t){let r="Initialization failed: ".concat(e.message||"Unknown error");b.oR.error(r),L(r),et(r)}}finally{t&&(W(!1),et("Wallet initialization complete"))}})(),()=>{t=!1}},[j,e,r,o,a,E]);let en=/^[a-zA-Z0-9_-][a-zA-Z0-9 _-]*$/,ei=["txt","pdf","jpg","jpeg","png","mp4","mp3","rtf","doc","docx","zip","tar","rar","exe","gz","7z","bz2","iso","apk","jar"],ea=e=>({txt:"text/plain",pdf:"application/pdf",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",mp4:"video/mp4",mp3:"audio/mpeg",rtf:"application/rtf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",zip:"application/zip",tar:"application/x-tar",rar:"application/x-rar-compressed",exe:"application/x-msdownload",gz:"application/gzip","7z":"application/x-7z-compressed",bz2:"application/x-bzip2",iso:"application/x-iso9660-image",apk:"application/vnd.android.package-archive",jar:"application/java-archive"})[e.toLowerCase()]||"application/octet-stream",es=async t=>{if(t.preventDefault(),L(""),D(""),K(!0),_(!1),G(""),et("Form submitted, starting deprotection process"),!j||!e||!r||!o||!a){b.oR.error("Please connect your wallet"),L("Please connect your wallet"),K(!1),et("Wallet not connected, aborting");return}if(!C||!N||!z||!F){b.oR.error("All fields are required"),L("All fields are required"),K(!1),et("Missing required fields");return}if(N.length>100){b.oR.error("Hidden block name must be 100 characters or less"),L("Hidden block name must be 100 characters or less"),K(!1),et("Hidden block name too long");return}if(!en.test(N)){b.oR.error("Hidden block name can only contain letters, numbers, underscores, hyphens, and spaces"),L("Hidden block name can only contain letters, numbers, underscores, hyphens, and spaces"),K(!1),et("Invalid hidden block name format");return}if(z.length>256||F.length>256){b.oR.error("Passwords must be 256 characters or less"),L("Passwords must be 256 characters or less"),K(!1),et("Password length exceeds maximum");return}try{let t,n,i,l=await k.getBalance(e),c=await k.getMinimumBalanceForRentExemption(0);if(l<c)throw Error("Insufficient SOL for transaction fees");let d=w({publicKey:e,signTransaction:r,signAllTransactions:o}),p=new s.NQ(k,d,{commitment:"confirmed"}),m=new s.BP(y,v,p);b.oR.info("Retrieving keys from Solana..."),et("Retrieving keys from Solana...");let u=await (0,g.H3)(m,k,e,N,a);if(!u.key1||!u.key2)throw Error("Retrieved keys are invalid or undefined");et("Keys retrieved successfully: key1=".concat(u.key1,", key2=").concat(u.key2)),U({user:e,fileName:N,transaction:u.signature}),et("Updating user trials...");let j=await (0,g.bt)(m,e);j?($({...j,user:e,trialCount:j.trialCount+1}),et("User trials updated: ".concat(j.trialCount+1," trials"))):et("User has no trial account to update."),b.oR.info("Processing file..."),et("Processing file...");let E=x.from(u.key1,"hex");if(12!==E.length)throw Error("Invalid nonce length: expected 12 bytes, got ".concat(E.length));et("Decoded key1 (nonce): ".concat(E.toString("hex")));try{t=x.from(u.key2,"base64").toString("utf8"),et("Decoded key2: ".concat(t))}catch(e){throw Error("Failed to decode key2: Ensure the hidden block name is correct")}let S=t.split(":"),R,P,B="";if(3===S.length)[R,P,B]=[Number(S[0]),Number(S[1]),S[2].toLowerCase()];else if(2===S.length)[R,P]=S.map(Number);else throw Error("Invalid key2 format: Expected 'offset:size[:extension]', got '".concat(t,"'"));if(isNaN(R)||isNaN(P))throw Error("Invalid key2 values: offset=".concat(R,", size=").concat(P));if(B&&!ei.includes(B))throw Error("Unsupported file extension in key2: .".concat(B,". Supported types: ").concat(ei.join(", ")));let I=await (0,h.ml)(C);if(et("File read: ".concat(I.byteLength," bytes")),I.byteLength<R+P+12)throw Error("Invalid file format: File is too small");let L=I.slice(R,R+P),A=new Uint8Array(I.slice(-12));if(et("Stored nonce (last 12 bytes): ".concat(x.from(A).toString("hex"))),!E.every((e,r)=>e===A[r]))throw Error("Nonce mismatch: key1 nonce=".concat(E.toString("hex"),", stored nonce=").concat(x.from(A).toString("hex")));et("Nonce validated successfully");try{n=await (0,f.I)(L,E,z,F),et("File decrypted successfully")}catch(r){let e="Incorrect passwords: Please verify your passwords and try again";throw b.oR.error(e,{toastId:"incorrect-passwords"}),G(e),_(!0),Error(e)}try{i=await (0,h.CV)(n),et("File decompressed successfully")}catch(e){throw Error("Decompression failed: File may be corrupted or not encrypted with this app")}let T="".concat(N,"_deprotected").concat(B?"."+B:""),M=ea(B),W=new Blob([i],{type:M}),H=URL.createObjectURL(W),K=document.createElement("a");K.href=H,K.download=T,b.oR.info("Preparing file for download..."),document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(H),b.oR.success("File deprotected successfully!"),D("File deprotected and saved as ".concat(T)),et("File downloaded: ".concat(T))}catch(r){let e=r.message.includes("Error:")?r.message:"Error: ".concat(r.message||"Unknown error occurred");r.message.includes("6000")?e="Unauthorized: Invalid user or hidden block name":r.message.includes("6051")?e="Invalid hidden block name provided":r.message.includes("6002")?e="Invalid key length provided":r.message.includes("6003")?e="Fee amount cannot be zero":r.message.includes("6004")?e="Fee amount is too large":r.message.includes("6005")?e="Maximum trial count cannot be zero":r.message.includes("6006")?e="Maximum trial count is too large":r.message.includes("Insufficient SOL")?e="Insufficient SOL for transaction fees":r.message.includes("Invalid nonce length")?e="Encryption error: Invalid nonce length":r.message.includes("Nonce mismatch")?e="Nonce mismatch: Ensure the correct file and hidden block name are used":r.message.includes("Incorrect passwords")?e="Incorrect passwords: Please verify your passwords and try again":r.message.includes("Decryption failed")?e="Decryption failed: Check your passwords or ensure the file was encrypted with this app":r.message.includes("Decompression failed")?e="Decompression failed: File may be corrupted or not encrypted with this app":r.message.includes("Invalid key2 format")||r.message.includes("Failed to decode key2")?e="Invalid encrypted file format: Ensure the hidden block name is correct":r.message.includes("Invalid key2 values")?e="Invalid key values: Ensure the hidden block name is correct":r.message.includes("Invalid file format")?e="Invalid file format: Ensure the file was encrypted correctly":r.message.includes("Unsupported file extension")?e="Unsupported file extension: ".concat(r.message):r.message.includes("Retrieved keys are invalid")&&(e="Failed to retrieve valid keys: Ensure the hidden block name is correct and the file was protected by this user"),r.message.includes("Incorrect passwords")||(b.oR.error(e),L(e)),et("Error: ".concat(e)),console.error("Deprotection error:",r)}finally{K(!1),et("Deprotection process completed")}};return Z&&J&&(Z.maxTrials,J.trialCount),(0,t.jsx)("div",{style:{minHeight:"100vh",padding:"3rem 0",background:"linear-gradient(to bottom, #111827, #000000)",color:"#d1d5db"},children:(0,t.jsxs)("div",{style:{maxWidth:"48rem",margin:"0 auto",padding:"0 1rem"},children:[(0,t.jsx)("div",{style:{marginBottom:"3rem"},children:(0,t.jsx)(p.A,{activeMode:"deprotect",isContractOwner:V})}),(0,t.jsx)("section",{style:{marginBottom:"3rem",textAlign:"center"},children:(0,t.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[(0,t.jsx)("h2",{style:{fontSize:"2.25rem",fontWeight:"700",color:"#f97316",marginBottom:"1rem"},children:"Deprotect Your Files"}),(0,t.jsx)("p",{style:{fontSize:"1.125rem",color:"#9ca3af",maxWidth:"32rem",margin:"0 auto"},children:"Upload your encrypted and protected file, enter the hidden block name and passwords, connect your Solana wallet, and decrypt your content."}),!M&&j&&J&&Z&&(0,t.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},style:{background:"rgba(59, 130, 246, 0.5)",backdropFilter:"blur(10px)",padding:"1rem",borderRadius:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"1rem",color:"#93c5fd"},children:[(0,t.jsxs)("p",{style:{fontSize:"1rem",fontWeight:"500"},children:[(0,t.jsx)("strong",{children:"Remaining Trials:"})," ",J&&Z?Z.maxTrials-J.trialCount>=0?Z.maxTrials-J.trialCount:0:"New user, trials pending"]}),(0,t.jsxs)("p",{style:{fontSize:"1rem",fontWeight:"500"},children:[(0,t.jsx)("strong",{children:"Fee After Trial:"})," ",Z.feeAmount/1e9," SOL"]})]})]})}),(0,t.jsx)("section",{style:{maxWidth:"48rem",margin:"0 auto"},children:(0,t.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",padding:"2rem",borderRadius:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,t.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#f97316",textAlign:"center"},children:"Deprotect File"}),I&&(0,t.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(239, 68, 68, 0.5)",color:"#f87171",padding:"1rem",borderRadius:"0.5rem",marginTop:"1rem"},children:I}),A&&(0,t.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(34, 197, 94, 0.5)",color:"#4ade80",padding:"1rem",borderRadius:"0.5rem",marginTop:"1rem"},children:A}),M&&(0,t.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(234, 179, 8, 0.5)",color:"#facc15",padding:"1rem",borderRadius:"0.5rem",marginTop:"1rem"},children:"Loading wallet..."}),!M&&!j&&(0,t.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(234, 179, 8, 0.5)",color:"#facc15",padding:"1rem",borderRadius:"0.5rem",marginTop:"1rem"},children:"Please connect your wallet to deprotect files."}),!M&&j&&e&&(0,t.jsxs)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(34, 197, 94, 0.5)",color:"#4ade80",padding:"1rem",borderRadius:"0.5rem",marginTop:"1rem"},children:["Wallet connected: ",e.toBase58().slice(0,4),"...",e.toBase58().slice(-4)]}),j&&(0,t.jsxs)("form",{onSubmit:es,style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#d1d5db",marginBottom:"0.5rem"},children:"Hidden Block Name"}),(0,t.jsx)("input",{type:"text",placeholder:"Enter hidden block name",value:N,onChange:e=>B(e.target.value),disabled:H,style:{width:"100%",background:"rgba(31, 41, 55, 0.5)",color:"#d1d5db",border:"1px solid #4b5563",borderRadius:"0.5rem",padding:"0.5rem 0.75rem",outline:"none",transition:"all 0.2s"}})]}),(0,t.jsx)("div",{children:(0,t.jsx)(c,{label:"Protected File",accept:ei.map(e=>".".concat(e)).join(","),onChange:S,fileName:null==C?void 0:C.name,disabled:H})}),(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{label:"Password 1",value:z,onChange:R,disabled:H})}),(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{label:"Password 2",value:F,onChange:P,disabled:H})}),(0,t.jsx)("div",{children:(0,t.jsx)(m.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:H||M||!j,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:H||M||!j?"#4b5563":"#f97316",color:"#ffffff",cursor:H||M||!j?"not-allowed":"pointer"},children:H?"Processing...":"Deprotect File"})}),T&&(0,t.jsxs)(m.P.div,{initial:{opacity:0},animate:{opacity:1},style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",padding:"1rem",borderRadius:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"1rem"},children:[(0,t.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#f97316"},children:"Retrieved File Event"}),(0,t.jsxs)("p",{style:{fontSize:"0.875rem",color:"#d1d5db"},children:[(0,t.jsx)("strong",{children:"User:"})," ",(0,t.jsxs)("span",{style:{cursor:"pointer",color:"#f97316"},onClick:()=>{navigator.clipboard.writeText(T.user.toBase58()),b.oR.success("Copied to clipboard!")},children:[T.user.toBase58().slice(0,4),"...",T.user.toBase58().slice(-4)]})]}),(0,t.jsxs)("p",{style:{fontSize:"0.875rem",color:"#d1d5db"},children:[(0,t.jsx)("strong",{children:"Hidden Block Name:"})," ",(0,t.jsx)("span",{style:{cursor:"pointer",color:"#f97316"},onClick:()=>{navigator.clipboard.writeText(T.fileName),b.oR.success("Copied to clipboard!")},children:T.fileName})]}),(0,t.jsxs)("p",{style:{fontSize:"0.875rem",color:"#d1d5db"},children:[(0,t.jsx)("strong",{children:"Transaction:"})," ",(0,t.jsxs)("span",{style:{cursor:"pointer",color:"#f97316"},onClick:()=>{navigator.clipboard.writeText(T.transaction),b.oR.success("Copied to clipboard!")},children:[T.transaction.slice(0,4),"...",T.transaction.slice(-4)]})]})]})]}),(0,t.jsx)(u,{isOpen:O,onClose:()=>_(!1),message:q}),(0,t.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,t.jsx)(m.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>eo(!er),style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontWeight:"600",transition:"all 0.3s",background:"#4b5563",color:"#ffffff",cursor:"pointer"},children:er?"Hide Debug Console":"Show Debug Console"}),er&&(0,t.jsxs)(m.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},style:{marginTop:"1rem",background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderRadius:"0.5rem",maxHeight:"24rem",overflowY:"auto"},children:[(0,t.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#d1d5db",marginBottom:"0.5rem"},children:"Debug Console"}),(0,t.jsx)("div",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:0===X.length?(0,t.jsx)("p",{children:"No logs available."}):X.map((e,r)=>(0,t.jsx)("p",{style:{borderBottom:"1px solid #374151",padding:"0.5rem 0"},children:e},r))})]})]})]})})]})})}},5695:(e,r,o)=>{"use strict";var t=o(8999);o.o(t,"useRouter")&&o.d(r,{useRouter:function(){return t.useRouter}})},8384:(e,r,o)=>{"use strict";o.d(r,{I:()=>a,o:()=>i});var t=o(4134);async function n(e,r){console.log("[Encryption] Generating key",{password1Length:e.length,password2Length:r.length});try{let o=new TextEncoder,t=await crypto.subtle.importKey("raw",o.encode(e+r),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);console.log("[Encryption] Key material imported");let n=await crypto.subtle.deriveKey({name:"PBKDF2",salt:o.encode("bprotector-salt"),iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]);return console.log("[Encryption] Key derived successfully"),n}catch(e){throw console.error("[Encryption] Key generation failed:",e),Error("Key generation failed: ".concat(e.message||"Unknown error"))}}async function i(e,r,o){console.log("[Encryption] Starting encryption, data length:",e.byteLength);try{let i=await n(r,o),a=crypto.getRandomValues(new Uint8Array(12));console.log("[Encryption] Nonce generated:",{hex:t.Buffer.from(a).toString("hex"),base64:t.Buffer.from(a).toString("base64")});let s=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},i,e);console.log("[Encryption] Data encrypted, length:",s.byteLength);let l=t.Buffer.from(a).toString("hex");return console.log("[Encryption] Key1 generated:",{key1:l,length:l.length}),{encryptedData:s,nonce:a,key1:l}}catch(e){throw console.error("[Encryption] Encryption failed:",e),Error("Encryption failed: ".concat(e.message||"Unknown error"))}}async function a(e,r,o,i){console.log("[Encryption] Starting decryption",{encryptedDataLength:e.byteLength,nonceLength:r.length,nonceHex:t.Buffer.from(r).toString("hex")});try{let t=await n(o,i);console.log("[Encryption] Decryption key generated");let a=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,e);return console.log("[Encryption] Data decrypted, length:",a.byteLength),a}catch(e){throw console.error("[Encryption] Decryption failed:",e),Error("OperationError"===e.name?"Incorrect passwords provided":"Decryption failed: ".concat(e.message||"Unknown error"))}}},8700:(e,r,o)=>{Promise.resolve().then(o.bind(o,5455))},9777:(e,r,o)=>{"use strict";o.d(r,{CV:()=>i,dg:()=>n,ml:()=>a});var t=o(9959);async function n(e){if(console.log("[Compression] Starting compression, data length:",e.byteLength),0===e.byteLength)throw console.error("[Compression] Invalid input: Empty data buffer"),Error("Invalid input: Empty data buffer");try{let r=(0,t.Kc)(new Uint8Array(e),{level:6});return console.log("[Compression] Compression successful, length:",r.length),r}catch(e){throw console.error("[Compression] Compression failed:",e),Error("Compression failed: ".concat(e.message||"Unknown error"))}}async function i(e){if(console.log("[Compression] Starting decompression, compressedData length:",e.byteLength),0===e.byteLength)throw console.error("[Compression] Invalid input: Empty compressed data"),Error("Invalid input: Empty compressed data");try{let r=(0,t.UD)(new Uint8Array(e));if(console.log("[Compression] Decompression successful, length:",r.length),r.length>0x40000000)throw console.error("[Compression] Decompressed data size exceeds maximum limit:",r.length),Error("Decompressed data size (".concat((r.length/1048576).toFixed(2)," MB) exceeds maximum allowed size (").concat("1024.00"," MB)"));let o=new ArrayBuffer(r.length);return new Uint8Array(o).set(r),o}catch(e){throw console.error("[Compression] Decompression failed:",e),Error("Decompression failed: ".concat(e.message||"Unknown error"))}}async function a(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0x1000000;if(console.log("[Compression] Reading file in chunks:",e.name,"size:",e.size),0===e.size)throw console.error("[Compression] Invalid input: Empty file",e.name),Error("Invalid input: Empty file");if(e.size>0x40000000)throw console.error("[Compression] File size exceeds maximum limit:",e.size),Error("File size (".concat((e.size/1048576).toFixed(2)," MB) exceeds maximum allowed size (").concat("1024.00"," MB)"));let o=new FileReader,t=0,n=[];return new Promise((i,a)=>{let s=()=>{let n=e.slice(t,t+r);console.log("[Compression] Reading chunk, offset:",t,"size:",n.size),o.readAsArrayBuffer(n)};o.onload=()=>{if(o.result instanceof ArrayBuffer)if(n.push(new Uint8Array(o.result)),console.log("[Compression] Chunk read, length:",o.result.byteLength),(t+=r)<e.size)s();else{let e=n.reduce((e,r)=>e+r.length,0);console.log("[Compression] All chunks read, total length:",e);let r=new Uint8Array(e),o=0;for(let e of n)r.set(e,o),o+=e.length;console.log("[Compression] File fully read, final length:",r.length),i(r.buffer)}},o.onerror=()=>{console.error("[Compression] File reading failed for:",e.name,"error:",o.error),a(Error("File reading failed for ".concat(e.name)))},s()})}}},e=>{var r=r=>e(e.s=r);e.O(0,[956,867,33,865,436,643,441,684,358],()=>r(8700)),_N_E=e.O()}]);